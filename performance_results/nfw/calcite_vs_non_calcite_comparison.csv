Query Name,PPL Query,Better Performance,Performance Improvement,Calcite Request Count,Non-Calcite Request Count,Calcite Median (ms),Non-Calcite Median (ms),Median Change,Calcite Average (ms),Non-Calcite Average (ms),Average Change,Calcite Min (ms),Non-Calcite Min (ms),Min Change,Calcite Max (ms),Non-Calcite Max (ms),Max Change,Calcite 95% (ms),Non-Calcite 95% (ms),95% Change,Calcite 99% (ms),Non-Calcite 99% (ms),99% Change,Calcite Requests/s,Non-Calcite Requests/s,Requests/s Change,Calcite Failures,Non-Calcite Failures
Aggregated,N/A,Non-Calcite,6.11% faster,5995,5949,38,27,40.74%,166.69832762535400,156.506733350252,6.51%,18.770291993860200,13.46270798239860,39.42%,5233.962833008260,17315.09433296740,-69.77%,120,53,126.42%,4200,4900,-14.29%,10.02113608890290,9.912885085396030,1.09%,0,652
PPL Query: nfw/01_sum_pkts_span_2d,"SOURCE = flint_new_data_source_default_amazon_networkfirewall__mview | stats sum(`aws.networkfirewall.event.netflow.pkts`) as packet_count by span(`aws.networkfirewall.event.timestamp`, 2d) as timestamp_span, `aws.networkfirewall.event.src_ip` | rename `aws.networkfirewall.event.src_ip` as `Source IP` | sort - packet_count | head 10",Calcite,11.92% faster,160,172,39,43,-9.30%,39.72667344532970,45.10461676731800,-11.92%,34.820750006474600,40.67270801169800,-14.39%,93.19533297093590,121.10374995973000,-23.05%,44,48,-8.33%,82,120,-31.67%,0.26745317334853500,0.28660551936260200,-6.68%,0,0
PPL Query: nfw/02_sum_bytes_span_2d,"SOURCE = flint_new_data_source_default_amazon_networkfirewall__mview | stats sum(`aws.networkfirewall.event.netflow.bytes`) as sum_bytes by span(`aws.networkfirewall.event.timestamp`, 2d) as timestamp_span, `aws.networkfirewall.event.src_ip` | rename  `aws.networkfirewall.event.src_ip` as `Source IP` | sort - sum_bytes | head 10",Calcite,12.50% faster,171,150,39,43,-9.30%,40.780656720846600,46.60640588030220,-12.50%,35.398082982283100,40.38387502077970,-12.35%,113.09404199710100,269.13058396894500,-57.98%,48,47,2.13%,90,170,-47.06%,0.28584057901624700,0.24994667386273400,14.36%,0,0
PPL Query: nfw/03_sum_pkts_span_2d_1,"SOURCE = flint_new_data_source_default_amazon_networkfirewall__mview | stats sum(`aws.networkfirewall.event.netflow.pkts`) as packet_count by span(`aws.networkfirewall.event.timestamp`, 2d) as timestamp_span, `aws.networkfirewall.event.dest_ip` | rename `aws.networkfirewall.event.dest_ip` as `Destination IP` | sort - packet_count | head 10",Calcite,14.29% faster,150,178,38,43,-11.63%,39.04612305108460,45.557213443255600,-14.29%,34.18362501543020,40.27208295883610,-15.12%,99.28991599008440,153.81120902020500,-35.45%,43,50,-14.00%,93,120,-22.50%,0.2507373500142520,0.296603386317111,-15.46%,0,0
PPL Query: nfw/04_sum_bytes_span_2d_1,"SOURCE = flint_new_data_source_default_amazon_networkfirewall__mview | stats sum(`aws.networkfirewall.event.netflow.bytes`) as bytes by span(`aws.networkfirewall.event.timestamp`, 2d) as timestamp_span, `aws.networkfirewall.event.dest_ip` | rename `aws.networkfirewall.event.dest_ip` as `Destination IP` | sort - bytes | head 10",Calcite,8.10% faster,158,150,38,43,-11.63%,42.18074710173180,45.89750807848760,-8.10%,34.36733304988590,40.189624996855900,-14.49%,208.93687498755800,137.95100001152600,51.46%,56,52,7.69%,170,140,21.43%,0.26411000868167900,0.24994667386273400,5.67%,0,0
PPL Query: nfw/05_sum_pkts,"SOURCE = flint_new_data_source_default_amazon_networkfirewall__mview | STATS SUM(`aws.networkfirewall.event.netflow.pkts`) as Packets, SUM(`aws.networkfirewall.event.netflow.bytes`) as Bytes by `aws.networkfirewall.event.src_ip` | RENAME `aws.networkfirewall.event.src_ip` as `Source IP` | SORT - Bytes, Packets | HEAD 10",Non-Calcite,27.50% faster,158,140,36,27,33.33%,39.21733674544640,28.43210649194330,37.93%,32.44941699085760,23.614457983057900,37.41%,206.05199999408800,205.0144590321000,0.51%,46,32,43.75%,110,56,96.43%,0.26411000868167900,0.23328356227188500,13.21%,0,0
PPL Query: nfw/06_sum_pkts_1,"SOURCE = flint_new_data_source_default_amazon_networkfirewall__mview | STATS SUM(`aws.networkfirewall.event.netflow.pkts`) as Packets, SUM(`aws.networkfirewall.event.netflow.bytes`) as Bytes by `aws.networkfirewall.event.dest_ip` | RENAME `aws.networkfirewall.event.dest_ip` as `Destination IP`  | SORT - Bytes, Packets | HEAD 10",Non-Calcite,17.57% faster,140,164,36,27,33.33%,37.86061807934730,31.208088658764300,21.32%,33.00470800604670,23.491083993576500,40.50%,216.53800003696200,225.83654103800700,-4.12%,40,37,8.11%,63,200,-68.50%,0.23402152667996800,0.2732750300899230,-14.36%,0,0
PPL Query: nfw/07_sum_pkts_span_2d_2,"SOURCE = flint_new_data_source_default_amazon_networkfirewall__mview | stats sum(`aws.networkfirewall.event.netflow.pkts`) as packet_count by span(`aws.networkfirewall.event.timestamp`, 2d) as timestamp_span, `aws.networkfirewall.event.src_ip`, `aws.networkfirewall.event.dest_ip` | eval `Src IP - Dst IP` = concat(`aws.networkfirewall.event.src_ip`, ""-"", `aws.networkfirewall.event.dest_ip`) | sort - packet_count | head 10",Non-Calcite,5.74% faster,173,168,51,47,8.51%,52.48289469917540,49.468808952951800,6.09%,47.53862495999780,43.87854196829720,8.34%,162.60720801074100,248.56133305002000,-34.58%,58,53,9.43%,74,120,-38.33%,0.28918374368310400,0.27994027472626200,3.30%,0,0
PPL Query: nfw/08_sum_bytes_span_2d_2,"SOURCE = flint_new_data_source_default_amazon_networkfirewall__mview | stats sum(`aws.networkfirewall.event.netflow.bytes`) as bytes by span(`aws.networkfirewall.event.timestamp`, 2d), `aws.networkfirewall.event.src_ip`, `aws.networkfirewall.event.dest_ip` | eval `Src IP - Dst IP` = concat(`aws.networkfirewall.event.src_ip`, ""-"", `aws.networkfirewall.event.dest_ip`) | sort - bytes | head 10",Non-Calcite,6.44% faster,181,171,52,47,10.64%,53.490681627454,50.04569637787950,6.88%,48.12687501544130,44.3636670242995,8.48%,179.347500030417,241.55625002458700,-25.75%,58,54,7.41%,120,160,-25.00%,0.3025564023505310,0.28493920820351700,6.18%,0,0
PPL Query: nfw/09_count_all_where_action_span_2d,"SOURCE = flint_new_data_source_default_amazon_networkfirewall__mview | where `aws.networkfirewall.event.alert.action` = ""allowed"" | stats count() as event_count by span(`aws.networkfirewall.event.timestamp`, 2d) as time_bucket, `aws.networkfirewall.event.http.hostname` | rename `aws.networkfirewall.event.http.hostname` as `Hostname` | sort - event_count",Non-Calcite,44.79% faster,178,136,30,16,87.50%,33.331806477148800,18.402825633101600,81.12%,26.75304200965910,13.85058299638330,93.15%,208.41195801040200,272.5046249688600,-23.52%,47,19,147.37%,120,24,400.00%,0.29754165535024500,0.22661831763554500,31.30%,0,0
PPL Query: nfw/11_count_all_where_action_span_2d_2,"SOURCE = flint_new_data_source_default_amazon_networkfirewall__mview | where `aws.networkfirewall.event.alert.action` = ""allowed"" | stats count() as event_count by span(`aws.networkfirewall.event.timestamp`, 2d) as time_bucket, `aws.networkfirewall.event.tls.sni` | rename `aws.networkfirewall.event.tls.sni` as `Hostname` | sort - event_count | HEAD 10",Non-Calcite,48.51% faster,163,148,35,17,105.88%,38.02372926869000,19.579760959950900,94.20%,32.22229104721920,13.63858295371760,136.26%,205.4300419986250,191.90029194578500,7.05%,43,22,95.45%,170,110,54.55%,0.2724679203488200,0.2466140515445640,10.48%,0,0
PPL Query: nfw/15_count_all,"SOURCE = flint_new_data_source_default_amazon_networkfirewall__mview | where (`aws.networkfirewall.event.tls.sni` like ""s3%"") or (`aws.networkfirewall.event.http.hostname` like ""s3%"") or (`aws.networkfirewall.event.tls.sni` like ""dynamodb%"") or (`aws.networkfirewall.event.http.hostname` like ""dynamodb%"") or (`aws.networkfirewall.event.tls.sni` like ""backup%"") or (`aws.networkfirewall.event.http.hostname` like ""backup%"") | STATS count() as Count by `aws.networkfirewall.event.src_ip`, `aws.networkfirewall.event.dest_ip`, `aws.networkfirewall.event.app_proto`, `aws.networkfirewall.event.tls.sni`, `aws.networkfirewall.event.http.hostname` | rename `aws.networkfirewall.event.tls.sni` as SNI, `aws.networkfirewall.event.dest_ip` as Dest_IP , `aws.networkfirewall.event.src_ip` as Source_IP, `aws.networkfirewall.event.http.hostname` as Hostname, `aws.networkfirewall.event.app_proto` as App_Proto | SORT - Count",Non-Calcite,27.76% faster,149,155,26,17,52.94%,28.40695830160480,20.519889768348200,38.44%,21.711208042688700,14.376292005181300,51.02%,201.8242499907500,197.80529098352400,2.03%,32,22,45.45%,140,140,0.00%,0.24906576768082300,0.25827822965815800,-3.57%,0,0
PPL Query: nfw/16_count_all_1,SOURCE = flint_new_data_source_default_amazon_networkfirewall__mview | STATS count() as Count by `aws.networkfirewall.event.proto` | SORT - Count | HEAD 10,Non-Calcite,28.31% faster,155,173,22,17,29.41%,24.272665077625100,17.402258684799500,39.48%,18.770291993860200,13.77808302640920,36.23%,79.41229199059310,70.09979203576220,13.28%,38,20,90.00%,67,43,55.81%,0.2590952616813940,0.28827183052168700,-10.12%,0,0
PPL Query: nfw/18_count_all_span_2d,"SOURCE = flint_new_data_source_default_amazon_networkfirewall__mview | stats count() as Count by SPAN(`aws.networkfirewall.event.timestamp`, 2d), `aws.networkfirewall.event.src_port` | eval `Source Port` = CAST(`aws.networkfirewall.event.src_port` AS STRING) | sort - Count | HEAD 10",Calcite,1.45% faster,166,184,43,44,-2.27%,45.84753894105450,46.5238678029298,-1.45%,39.32412504218520,40.05029099062090,-1.81%,170.87487498065500,264.20195802347700,-35.32%,49,48,2.08%,160,220,-27.27%,0.2774826673491050,0.30660125327162000,-9.50%,0,0
PPL Query: nfw/19_count_all_span_2d_1,"SOURCE = flint_new_data_source_default_amazon_networkfirewall__mview | stats count() as Count by SPAN(`aws.networkfirewall.event.timestamp`, 2d), `aws.networkfirewall.event.dest_port` | eval `Destination Port` = CAST(`aws.networkfirewall.event.dest_port` AS STRING) | sort - Count | HEAD 10\",Non-Calcite,40.78% faster,133,158,32,18,77.78%,35.092174835307000,20.780459111571100,68.87%,28.254957986064300,14.523666992317900,94.54%,162.59537503356100,191.88945804489800,-15.27%,40,23,73.91%,150,150,0.00%,0.22232045034597000,0.2632771631354130,-15.56%,0,0
PPL Query: nfw/20_count_all_where_proto_span_2d,"SOURCE = flint_new_data_source_default_amazon_networkfirewall__mview | WHERE `aws.networkfirewall.event.proto` = ""TCP"" | STATS count() as Count by SPAN(`aws.networkfirewall.event.timestamp`, 2d), `aws.networkfirewall.event.src_ip`, `aws.networkfirewall.event.dest_ip`, `aws.networkfirewall.event.dest_port` | EVAL `Src IP - Dst IP:Port` = CONCAT(`aws.networkfirewall.event.src_ip`, "" - "", `aws.networkfirewall.event.dest_ip`, "": "", CAST(`aws.networkfirewall.event.dest_port` AS STRING)) | SORT - Count | HEAD 10",Non-Calcite,51.26% faster,159,149,100.0,49,104.08%,105.8774787739340,51.605497757613600,105.17%,96.82899998733770,45.522416010499,112.71%,221.42887499649100,253.99762496817900,-12.82%,140,53,164.15%,170,170,0.00%,0.2657815910151070,0.2482803627036490,7.05%,0,0
PPL Query: nfw/21_sum_pkts_where_proto_span_2d,"SOURCE = flint_new_data_source_default_amazon_networkfirewall__mview | WHERE `aws.networkfirewall.event.proto` = ""TCP"" | STATS sum(aws.networkfirewall.event.netflow.pkts) as Packets by SPAN(`aws.networkfirewall.event.timestamp`, 2d), `aws.networkfirewall.event.src_ip`, `aws.networkfirewall.event.dest_ip`, `aws.networkfirewall.event.dest_port` | EVAL `Src IP - Dst IP:Port` = CONCAT(`aws.networkfirewall.event.src_ip`, "" - "", `aws.networkfirewall.event.dest_ip`, "": "", CAST(`aws.networkfirewall.event.dest_port` AS STRING)) | SORT - Packets | HEAD 10",Non-Calcite,54.79% faster,165,149,110.0,50,120.00%,111.78619264921300,50.537553464684400,121.19%,103.28895901329800,46.883625036571200,120.31%,286.4703339873810,97.12429199134930,194.95%,120,53,126.42%,170,77,120.78%,0.27581108501567700,0.2482803627036490,11.09%,0,0
PPL Query: nfw/22_sum_bytes_where_proto_span_2d,"SOURCE = flint_new_data_source_default_amazon_networkfirewall__mview | WHERE `aws.networkfirewall.event.proto` = ""TCP"" | STATS sum(aws.networkfirewall.event.netflow.bytes) as Bytes by SPAN(`aws.networkfirewall.event.timestamp`, 2d), `aws.networkfirewall.event.src_ip`, `aws.networkfirewall.event.dest_ip`, `aws.networkfirewall.event.dest_port` | EVAL `Src IP - Dst IP:Port` = CONCAT(`aws.networkfirewall.event.src_ip`, "" - "", `aws.networkfirewall.event.dest_ip`, "": "", CAST(`aws.networkfirewall.event.dest_port` AS STRING)) | SORT - Bytes | HEAD 10",Non-Calcite,55.69% faster,176,156,110.0,49,124.49%,112.515567027334,49.85242440866740,125.70%,103.48787502152800,45.782749948557500,126.04%,297.082583012525,74.99016699148340,296.16%,140,53,164.15%,190,65,192.31%,0.29419849068338900,0.25994454081724300,13.18%,0,0
PPL Query: nfw/23_count_all_2,SOURCE = flint_new_data_source_default_amazon_networkfirewall__mview | STATS count() as Count by `aws.networkfirewall.event.tcp.tcp_flags` | SORT - Count | HEAD 10,Non-Calcite,11.12% faster,160,160,23,18,27.78%,23.43144187652800,20.82586699143580,12.51%,19.046291010454300,15.036083001177800,26.67%,31.684083049185600,115.94754195539300,-72.67%,26,31,-16.13%,30,100,-70.00%,0.26745317334853500,0.2666097854535830,0.32%,0,0
PPL Query: nfw/24_count_all_where_proto_span_2d_1,"SOURCE = flint_new_data_source_default_amazon_networkfirewall__mview | WHERE `aws.networkfirewall.event.proto` = ""UDP"" | STATS count() as Count by SPAN(`aws.networkfirewall.event.timestamp`, 2d), `aws.networkfirewall.event.src_ip`, `aws.networkfirewall.event.dest_ip`, `aws.networkfirewall.event.dest_port` | EVAL `Src IP - Dst IP:Port` = CONCAT(`aws.networkfirewall.event.src_ip`, "" - "", `aws.networkfirewall.event.dest_ip`, "": "", CAST(`aws.networkfirewall.event.dest_port` AS STRING)) | SORT - Count | HEAD 10",Non-Calcite,50.44% faster,164,171,100.0,48,108.33%,105.2000117108440,52.1401466389203,101.76%,96.85654198983680,44.775832968298300,116.31%,271.46629197523,298.86904096929400,-9.17%,120,59,103.39%,220,270,-18.52%,0.2741395026822490,0.28493920820351700,-3.79%,0,0
PPL Query: nfw/25_sum_pkts_where_proto_span_2d_1,"SOURCE = flint_new_data_source_default_amazon_networkfirewall__mview | WHERE `aws.networkfirewall.event.proto` = ""UDP"" | STATS sum(`aws.networkfirewall.event.netflow.pkts`) as Packets by SPAN(`aws.networkfirewall.event.timestamp`, 2d), `aws.networkfirewall.event.src_ip`, `aws.networkfirewall.event.dest_ip`, `aws.networkfirewall.event.dest_port` | EVAL `Src IP - Dst IP:Port` = CONCAT(`aws.networkfirewall.event.src_ip`, "" - "", `aws.networkfirewall.event.dest_ip`, "": "", CAST(`aws.networkfirewall.event.dest_port` AS STRING)) | SORT - Packets | HEAD 10",Non-Calcite,54.91% faster,201,155,110.0,50,120.00%,110.66211941414500,49.893397575004000,121.80%,103.24662498896900,45.917083974927700,124.85%,221.5797079843470,59.77583397179840,270.68%,120,53,126.42%,160,59,171.19%,0.3359880490190970,0.25827822965815800,30.09%,0,0
PPL Query: nfw/26_sum_bytes_where_proto_span_2d_1,"SOURCE = flint_new_data_source_default_amazon_networkfirewall__mview | WHERE `aws.networkfirewall.event.proto` = ""UDP"" | STATS sum(`aws.networkfirewall.event.netflow.bytes`) as Bytes by SPAN(`aws.networkfirewall.event.timestamp`, 2d), `aws.networkfirewall.event.src_ip`, `aws.networkfirewall.event.dest_ip`, `aws.networkfirewall.event.dest_port` | EVAL `Src IP - Dst IP:Port` = CONCAT(`aws.networkfirewall.event.src_ip`, "" - "", `aws.networkfirewall.event.dest_ip`, "": "", CAST(`aws.networkfirewall.event.dest_port` AS STRING)) | SORT - Bytes | HEAD 10",Non-Calcite,54.99% faster,157,155,110.0,49,124.49%,111.67597790414800,50.26975051544970,122.15%,103.20958303054800,46.19245801586660,123.43%,278.4269159892570,124.4644169928510,123.70%,130,54,140.74%,240,65,269.23%,0.2624384263482500,0.25827822965815800,1.61%,0,0
PPL Query: nfw/27_count_all_where_proto_span_1d,"SOURCE = flint_new_data_source_default_amazon_networkfirewall__mview | WHERE `aws.networkfirewall.event.proto` = ""ICMP"" | STATS count() as Count by SPAN(`aws.networkfirewall.event.timestamp`, 1d), `aws.networkfirewall.event.src_ip`, `aws.networkfirewall.event.dest_ip`, `aws.networkfirewall.event.dest_port` | EVAL `Src IP - Dst IP:Port` = CONCAT(`aws.networkfirewall.event.src_ip`, "" - "", `aws.networkfirewall.event.dest_ip`, "": "", CAST(`aws.networkfirewall.event.dest_port` AS STRING)) | SORT - Count | HEAD 10",Non-Calcite,50.48% faster,154,166,100.0,49,104.08%,105.06109822149900,52.0234849266792,101.95%,97.01224998570980,45.382666983641700,113.76%,219.39458401175200,169.36320898821600,29.54%,120,55,118.18%,190,160,18.75%,0.2574236793479650,0.27660765240809200,-6.94%,0,0
PPL Query: nfw/28_count_all_where_action,"SOURCE = flint_new_data_source_default_amazon_networkfirewall__mview | WHERE aws.networkfirewall.event.alert.action= ""blocked"" | STATS count() as Count by `aws.networkfirewall.event.alert.signature_id`, `aws.networkfirewall.event.alert.action`, `aws.networkfirewall.event.alert.signature`, `aws.networkfirewall.event.proto` | RENAME  `aws.networkfirewall.event.alert.signature_id` as SID, `aws.networkfirewall.event.alert.action` as Action, `aws.networkfirewall.event.alert.signature` as Message, `aws.networkfirewall.event.proto` as Proto | SORT - Count | HEAD 10",Non-Calcite,43.35% faster,155,172,25,17,47.06%,30.070144093159800,17.035029538525400,76.52%,22.055125038605200,13.594583026133500,62.23%,208.02183396881400,40.74295802274720,410.57%,55,20,175.00%,140,27,418.52%,0.2590952616813940,0.28660551936260200,-9.60%,0,0
PPL Query: nfw/29_count_all_where_action_1,"SOURCE = flint_new_data_source_default_amazon_networkfirewall__mview| where `aws.networkfirewall.event.alert.action` = ""allowed"" | stats count() as Count by `aws.networkfirewall.event.alert.signature_id`, `aws.networkfirewall.event.alert.action`, `aws.networkfirewall.event.alert.signature`, `aws.networkfirewall.event.proto` | rename `aws.networkfirewall.event.alert.signature_id` as SID, `aws.networkfirewall.event.alert.action` as Action, `aws.networkfirewall.event.alert.signature` as Message, `aws.networkfirewall.event.proto` as Proto | sort - Count | head 10",Non-Calcite,33.70% faster,167,159,25,17,47.06%,27.8407422582407,18.45863550343500,50.83%,22.170208976604000,13.818749983329300,60.44%,144.1276249825020,131.4813339849930,9.62%,32,20,60.00%,140,83,68.67%,0.27915424968253400,0.264943474294498,5.36%,0,0
PPL Query: nfw/30_count_all_where_action_2,"SOURCE = flint_new_data_source_default_amazon_networkfirewall__mview | WHERE `aws.networkfirewall.event.alert.action` = ""blocked""| STATS COUNT() as Count by `aws.networkfirewall.event.src_ip`| SORT - Count| HEAD 10",Non-Calcite,29.16% faster,162,177,24,17,41.18%,25.401259833561600,17.994624714164500,41.16%,20.077708002645500,14.220874989405300,41.18%,191.99237501015900,134.2820000136270,42.98%,27,20,35.00%,87,74,17.57%,0.27079633801539200,0.2949370751580260,-8.19%,0,0
PPL Query: nfw/31_count_all_where_action_3,"SOURCE = flint_new_data_source_default_amazon_networkfirewall__mview | WHERE `aws.networkfirewall.event.alert.action` = ""blocked"" | STATS COUNT() as Count by `aws.networkfirewall.event.dest_ip`| SORT - Count | HEAD 10",Non-Calcite,32.78% faster,161,170,24,17,41.18%,26.990045563054600,18.142849513370700,48.76%,20.27745801024140,13.954583031591000,45.31%,193.61566699808500,106.1948339920490,82.32%,34,20,70.00%,150,84,78.57%,0.2691247556819640,0.2832728970444320,-4.99%,0,0
PPL Query: nfw/32_count_all_where_action_4,"SOURCE = flint_new_data_source_default_amazon_networkfirewall__mview | WHERE `aws.networkfirewall.event.alert.action` = ""blocked"" | STATS COUNT() as `Count` by `aws.networkfirewall.event.dest_port` | EVAL `Destination Port` = CAST(`aws.networkfirewall.event.dest_port` as STRING) | SORT - `Count` | HEAD 10",Non-Calcite,53.30% faster,168,147,33,17,94.12%,36.43795037489670,17.016971135372600,114.13%,28.836584009695800,13.46270798239860,114.20%,203.86637496994800,26.497667015064500,669.37%,44,20,120.00%,200,22,809.09%,0.280825832015962,0.24494774038547900,14.65%,0,0
PPL Query: nfw/33_count_all_where_action_span_2d_4,"SOURCE = flint_new_data_source_default_amazon_networkfirewall__mview | WHERE `aws.networkfirewall.event.alert.action` = ""blocked"" | STATS count() as Count by SPAN(`aws.networkfirewall.event.timestamp`, 2d), `aws.networkfirewall.event.src_ip`, `aws.networkfirewall.event.dest_ip`, `aws.networkfirewall.event.dest_port` | EVAL `Src IP - Dst IP:Port` = CONCAT(`aws.networkfirewall.event.src_ip`, "" - "", `aws.networkfirewall.event.dest_ip`, "": "", CAST(`aws.networkfirewall.event.dest_port` AS STRING)) | SORT - Count | HEAD 10",Non-Calcite,76.27% faster,153,165,88,17,417.65%,89.54897385662770,21.2477674122166,321.45%,83.88004096923400,14.008165977429600,498.79%,145.52433299832000,266.19624998420500,-45.33%,93,23,304.35%,130,200,-35.00%,0.25575209701453700,0.2749413412490070,-6.98%,0,0
PPL Query: nfw/34_count_all_where_action_span_2d_5,"SOURCE = flint_new_data_source_default_amazon_networkfirewall__mview | WHERE `aws.networkfirewall.event.alert.action` = 'blocked' and `aws.networkfirewall.event.proto` = 'TCP' | STATS count() as Count by SPAN(`aws.networkfirewall.event.timestamp`, 2d), `aws.networkfirewall.event.src_ip`, `aws.networkfirewall.event.dest_ip`, `aws.networkfirewall.event.dest_port`| EVAL `Src IP - Dst IP:Port` = CONCAT(`aws.networkfirewall.event.src_ip`, "" - "", `aws.networkfirewall.event.dest_ip`, "": "", CAST(`aws.networkfirewall.event.dest_port` AS STRING)) | SORT - Count | HEAD 10",Non-Calcite,78.77% faster,163,151,90,17,429.41%,92.32615646934770,19.602265151522900,371.00%,85.51854098914190,14.099791995249700,506.52%,204.73641698481500,249.45287499576800,-17.93%,99,21,371.43%,170,89,91.01%,0.2724679203488200,0.2516129850218190,8.29%,0,0
PPL Query: nfw/35_count_all_where_action_span_2d_6,"SOURCE = flint_new_data_source_default_amazon_networkfirewall__mview| WHERE `aws.networkfirewall.event.alert.action` = 'blocked' and `aws.networkfirewall.event.proto` = 'UDP' | STATS count() as Count by SPAN(`aws.networkfirewall.event.timestamp`, 2d), `aws.networkfirewall.event.src_ip`, `aws.networkfirewall.event.dest_ip`, `aws.networkfirewall.event.dest_port` | EVAL `Src IP - Dst IP:Port` = CONCAT(`aws.networkfirewall.event.src_ip`, "" - "", `aws.networkfirewall.event.dest_ip`, "": "", CAST(`aws.networkfirewall.event.dest_port` AS STRING)) | SORT - Count | HEAD 10",Non-Calcite,80.23% faster,158,149,90,17,429.41%,90.6634372205892,17.926299469483000,405.76%,84.79041600367050,13.868790993001300,511.38%,138.81762500386700,112.27145802695300,23.64%,97,20,385.00%,110,44,150.00%,0.26411000868167900,0.2482803627036490,6.38%,0,0
PPL Query: nfw/36_count_all_where_proto_span_2d_2,"SOURCE = flint_new_data_source_default_amazon_networkfirewall__mview | WHERE `aws.networkfirewall.event.proto` = 'TCP' and `aws.networkfirewall.event.netflow.age` > 350 | STATS count() as Count by SPAN(`aws.networkfirewall.event.timestamp`, 2d), `aws.networkfirewall.event.src_ip`, `aws.networkfirewall.event.src_port`, `aws.networkfirewall.event.dest_ip`, `aws.networkfirewall.event.dest_port` | EVAL `Src IP:Port - Dst IP:Port` = CONCAT(`aws.networkfirewall.event.src_ip`, "": "", CAST(`aws.networkfirewall.event.src_port` AS STRING), "" - "", `aws.networkfirewall.event.dest_ip`, "": "", CAST(`aws.networkfirewall.event.dest_port` AS STRING)) | SORT - Count | HEAD 10",Non-Calcite,52.14% faster,162,179,110.0,51,115.69%,112.10894343201800,53.65176600281820,108.96%,103.67766703711800,47.6689159986563,117.50%,282.6847499818540,296.36537499027300,-4.62%,130,61,113.11%,180,150,20.00%,0.27079633801539200,0.29826969747619600,-9.21%,0,0
PPL Query: nfw/37_count_all_where_proto_span_2d_3,"SOURCE = flint_new_data_source_default_amazon_networkfirewall__mview | WHERE `aws.networkfirewall.event.proto` = 'TCP' and `aws.networkfirewall.event.tcp.syn` = ""true"" and `aws.networkfirewall.event.tcp.ack` = ""true"" | STATS count() as Count by SPAN(`aws.networkfirewall.event.timestamp`, 2d), `aws.networkfirewall.event.src_ip`, `aws.networkfirewall.event.src_port`, `aws.networkfirewall.event.dest_ip`, `aws.networkfirewall.event.dest_port`| EVAL `Src IP:Port - Dst IP:Port` = CONCAT(`aws.networkfirewall.event.src_ip`, "": "", CAST(`aws.networkfirewall.event.src_port` AS STRING), "" - "", `aws.networkfirewall.event.dest_ip`, "": "", CAST(`aws.networkfirewall.event.dest_port` AS STRING)) | SORT - Count | HEAD 10",Non-Calcite,98.74% faster,160,157,4100.0,51,7939.22%,4163.596589894590,52.40435458409780,7845.13%,3953.420375008140,47.322124999482200,8254.27%,5233.962833008260,156.5710409777240,3242.87%,4500,55,8081.82%,4800,120,3900.00%,0.26745317334853500,0.2616108519763280,2.23%,0,0
